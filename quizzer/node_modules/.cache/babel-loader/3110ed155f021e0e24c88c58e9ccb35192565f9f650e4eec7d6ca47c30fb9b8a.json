{"ast":null,"code":"import React,{useState,useEffect}from'react';import Table from'react-bootstrap/Table';import{useNavigate,Link}from'react-router-dom';import logo from'./logo.svg';import userIcon from'./user.svg';import logoutIcon from'./logout.svg';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ProfilePage(){const[userInfo,setUserInfo]=useState(null);const[userClassement,setUserClassement]=useState([]);const[isLoading,setIsLoading]=useState(true);const navigate=useNavigate();useEffect(()=>{async function fetchUserInfo(){// Obtenir le token JWT du localStorage\nconst token=localStorage.getItem('userToken');if(!token){console.error('Token is not available');setIsLoading(false);navigate('/');// Redirigez l'utilisateur vers la page de connexion si le token n'est pas là\nreturn;}try{console.log(\"profile \".concat(token));const response=await fetch('http://localhost:8080/userinfo',{method:'GET',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)}});if(!response.ok){throw new Error('Failed to fetch user info.');}const data=await response.json();setUserInfo(data.userInfo);setUserClassement(data.ranking);}catch(error){console.error('Erreur lors de la récupération des informations de l\\'utilisateur',error);navigate('/');// Redirigez l'utilisateur vers la page de connexion en cas d'erreur\n}finally{setIsLoading(false);}}fetchUserInfo();},[navigate]);const signOut=()=>{localStorage.removeItem('userToken');// Supprime le token du localStorage\nnavigate('/');};if(isLoading){return/*#__PURE__*/_jsx(\"p\",{children:\"Chargement des informations de l'utilisateur...\"});}if(!userInfo){return/*#__PURE__*/_jsx(\"p\",{children:\"Impossible d'afficher les informations de l'utilisateur\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"profile-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo-container\",children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(\"img\",{src:logo,alt:\"Logo\",className:\"home-logo\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-logout-container\",children:[/*#__PURE__*/_jsx(Link,{to:\"/profile\",children:/*#__PURE__*/_jsx(\"img\",{src:userIcon,alt:\"Profil Utilisateur\",className:\"user-icon\"})}),/*#__PURE__*/_jsx(\"img\",{src:logoutIcon,alt:\"D\\xE9connexion\",className:\"logout-icon\",onClick:signOut,style:{cursor:'pointer'}})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-content\",children:[/*#__PURE__*/_jsx(\"h2\",{children:userInfo.pseudo}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Nombre de parties : \",userInfo.nbDeParties]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Score total : \",userInfo.scoreTotal]}),/*#__PURE__*/_jsx(\"h3\",{children:\"Historique des scores\"}),userInfo.scoreHistory&&userInfo.scoreHistory.length>0?/*#__PURE__*/_jsxs(\"table\",{striped:true,bordered:true,hover:true,size:\"sm\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"# Partie\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Score\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:userInfo.scoreHistory.map((score,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:score})]},index))})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Aucun historique de score disponible.\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"Classement\"}),userClassement&&userClassement.length>0?/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Position\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Pseudo\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Score\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:userClassement.map((user,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:user.pseudo}),/*#__PURE__*/_jsx(\"td\",{children:user.scoreTotal})]},index))})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Le classement n'est pas encore disponible.\"})]})]});}export default ProfilePage;","map":{"version":3,"names":["React","useState","useEffect","Table","useNavigate","Link","logo","userIcon","logoutIcon","jsx","_jsx","jsxs","_jsxs","ProfilePage","userInfo","setUserInfo","userClassement","setUserClassement","isLoading","setIsLoading","navigate","fetchUserInfo","token","localStorage","getItem","console","error","log","concat","response","fetch","method","headers","ok","Error","data","json","ranking","signOut","removeItem","children","className","to","src","alt","onClick","style","cursor","pseudo","nbDeParties","scoreTotal","scoreHistory","length","striped","bordered","hover","size","map","score","index","user"],"sources":["/Users/vepa/Desktop/Projet_PC3R/spotrend-quizzer/src/ProfilePage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Table from 'react-bootstrap/Table';\nimport { useNavigate, Link } from 'react-router-dom';\nimport logo from './logo.svg'; \nimport userIcon from './user.svg';\nimport logoutIcon from './logout.svg'; \n\nfunction ProfilePage() {\n  const [userInfo, setUserInfo] = useState(null);\n  const [userClassement, setUserClassement] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    async function fetchUserInfo() {\n      // Obtenir le token JWT du localStorage\n      const token = localStorage.getItem('userToken');\n      \n      if (!token) {\n        console.error('Token is not available');\n        setIsLoading(false);\n        navigate('/'); // Redirigez l'utilisateur vers la page de connexion si le token n'est pas là\n        return;\n      }\n\n      try {\n        console.log(`profile ${token}`);\n        const response = await fetch('http://localhost:8080/userinfo', {\n          method: 'GET',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${token}`\n          }\n        });\n\n        if (!response.ok) {\n          throw new Error('Failed to fetch user info.');\n        }\n\n        const data = await response.json();\n        setUserInfo(data.userInfo);\n        setUserClassement(data.ranking);\n      } catch (error) {\n        console.error('Erreur lors de la récupération des informations de l\\'utilisateur', error);\n        navigate('/'); // Redirigez l'utilisateur vers la page de connexion en cas d'erreur\n      } finally {\n        setIsLoading(false);\n      }\n    }\n\n    fetchUserInfo();\n  }, [navigate]);\n\n  const signOut = () => {\n    localStorage.removeItem('userToken'); // Supprime le token du localStorage\n    navigate('/');\n  };\n\n  if (isLoading) {\n    return <p>Chargement des informations de l'utilisateur...</p>;\n  }\n\n  if (!userInfo) {\n    return <p>Impossible d'afficher les informations de l'utilisateur</p>;\n  }\n\n  return (\n      <div className=\"profile-page\">\n        <div className=\"sidebar\">\n          {/* Logo en haut */}\n          <div className=\"logo-container\">\n            <Link to=\"/\"><img src={logo} alt=\"Logo\" className=\"home-logo\" /></Link>\n          </div>\n\n          {/* Utilisateur et déconnexion en bas */}\n          <div className=\"user-logout-container\">\n            <Link to=\"/profile\"><img src={userIcon} alt=\"Profil Utilisateur\" className=\"user-icon\" /></Link>\n            <img src={logoutIcon} alt=\"Déconnexion\" className=\"logout-icon\" onClick={signOut} style={{cursor: 'pointer'}} />\n          </div>\n        </div>\n        <div className=\"profile-content\">\n          <h2>{userInfo.pseudo}</h2>\n          <p>Nombre de parties : {userInfo.nbDeParties}</p>\n          <p>Score total : {userInfo.scoreTotal}</p>\n          <h3>Historique des scores</h3>\n          {userInfo.scoreHistory && userInfo.scoreHistory.length > 0 ? (\n          <table striped bordered hover size=\"sm\">\n            <thead>\n              <tr>\n                <th># Partie</th>\n                <th>Score</th>\n              </tr>\n            </thead>\n            <tbody>\n              {userInfo.scoreHistory.map((score, index) => (\n                <tr key={index}>\n                  <td>{index + 1}</td>\n                  <td>{score}</td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        ) : (\n          <p>Aucun historique de score disponible.</p>\n        )}\n        <h3>Classement</h3>\n        {userClassement && userClassement.length > 0 ? (\n          <table>\n            <thead>\n              <tr>\n                <th>Position</th>\n                <th>Pseudo</th>\n                <th>Score</th>\n              </tr>\n            </thead>\n            <tbody>\n              {userClassement.map((user, index) => (\n                <tr key={index}>\n                  <td>{index + 1}</td>\n                  <td>{user.pseudo}</td>\n                  <td>{user.scoreTotal}</td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        ) : (\n          <p>Le classement n'est pas encore disponible.</p>\n        )}\n      </div>\n      </div>\n  );\n}\n\nexport default ProfilePage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}